<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>إنشاء حساب</title><style>
body{
background:#0b1622;
font-family:Tahoma;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
color:white;
}

.box{
width:90%;
max-width:400px;
background:#122436;
padding:25px;
border-radius:15px;
box-shadow:0 0 25px rgba(0,0,0,.4);
}

h2{
text-align:center;
margin-bottom:20px;
}

input{
width:100%;
padding:14px;
margin:10px 0;
border-radius:10px;
border:none;
background:#1b3148;
color:white;
font-size:16px;
}

input::placeholder{
color:#9fb3c8;
}

button{
width:100%;
padding:14px;
margin-top:15px;
background:#2ecc71;
border:none;
border-radius:12px;
font-size:18px;
color:white;
cursor:pointer;
}

button:hover{
background:#27ae60;
}

.link{
text-align:center;
margin-top:15px;
}

.link a{
color:#4fc3f7;
text-decoration:none;
}
</style></head><body><div class="box">
<h2>إنشاء حساب</h2><form id="registerForm"><input id="username" placeholder="اسم المستخدم مثال: @ali" required><input id="email" type="email" placeholder="البريد الإلكتروني" required><input id="password" type="password" placeholder="كلمة المرور" required><button type="submit">إنشاء الحساب</button>

</form><div class="link">
لديك حساب؟ <a href="login.html">تسجيل الدخول</a>
</div></div><!-- Firebase --><script type="module">

import { auth, db } from "./app/firebase.js";
import { createUserWithEmailAndPassword } from 
"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { ref, set } from 
"https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const form = document.getElementById("registerForm");

form.addEventListener("submit", async (e)=>{
e.preventDefault();

const username = document.getElementById("username").value.trim().toLowerCase();
const email = document.getElementById("email").value.trim();
const password = document.getElementById("password").value.trim();

if(!username.startsWith("@")){
alert("يجب أن يبدأ اسم المستخدم بعلامة @");
return;
}

try{

// إنشاء حساب Firebase
const userCred = await createUserWithEmailAndPassword(auth,email,password);
const user = userCred.user;

// حفظ بيانات المستخدم في قاعدة البيانات
await set(ref(db,"users/"+user.uid),{
username: username,
email: email,
uid: user.uid
});

// فهرس البحث (الأهم)
await set(ref(db,"usernames/"+username), user.uid);

// الانتقال للتطبيق
window.location.href = "app/";

}catch(error){
alert(error.message);
}

});
</script></body>
</html>
