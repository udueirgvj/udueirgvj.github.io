<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ุชูุฑููุจ - ุฏุฑุฏุดุฉ ุขููุฉ</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <!-- CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app">
        <!-- ===== ุดุงุดุงุช ุงููุตุงุฏูุฉ (ุงูุชุตููู ุงููุฏูู ููุง ูู ุตูุฑุชู) ===== -->
        <div id="authContainer" class="auth-container">
            <!-- ุชุณุฌูู ุงูุฏุฎูู -->
            <div id="loginContainer" class="auth-box">
                <div style="text-align: center; margin-bottom: 25px;">
                    <h1 style="color: #667eea; font-size: 40px; margin-bottom: 5px;">ุชูุฑููุจ</h1>
                    <p style="color: #666;">ูุฑุญุจุงู ุจูู ูู ุชูุฑููุจ</p>
                </div>
                <input type="email" id="loginEmail" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" dir="ltr">
                <input type="password" id="loginPassword" placeholder="ูููุฉ ุงููุฑูุฑ">
                <div id="loginError" class="error"></div>
                <button onclick="handleLogin()">ุฏุฎูู</button>
                <button class="link-btn" onclick="UI.showSignup()">ุฅูุดุงุก ุญุณุงุจ</button>
            </div>

            <!-- ุฅูุดุงุก ุญุณุงุจ -->
            <div id="signupContainer" class="auth-box hidden">
                <h2 style="text-align: center; margin-bottom: 25px; color: #333;">ุฅูุดุงุก ุญุณุงุจ</h2>
                <input type="text" id="signupFullname" placeholder="ุงูุงุณู ุงูุดุฎุตู">
                <input type="text" id="signupUsername" placeholder="ุงุณู ุงููุณุชุฎุฏู (5-10 ุฃุญุฑู ุฅูุฌููุฒูุฉ)">
                <input type="email" id="signupEmail" placeholder="ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" dir="ltr">
                <input type="password" id="signupPassword" placeholder="ูููุฉ ุงููุฑูุฑ">
                <input type="password" id="signupConfirm" placeholder="ุชุฃููุฏ ูููุฉ ุงููุฑูุฑ">
                <div id="signupError" class="error"></div>
                <div id="signupSuccess" class="success"></div>
                <button onclick="handleSignUp()">ุชุณุฌูู</button>
                <button class="link-btn" onclick="UI.showLogin()">ูุฏูู ุญุณุงุจุ ุณุฌู ุฏุฎููู</button>
            </div>

            <!-- ุชุญูู ุงูุจุฑูุฏ -->
            <div id="verificationContainer" class="auth-box hidden">
                <div style="text-align: center;">
                    <h2 style="color: #27ae60; margin-bottom: 20px;">ุชุญูู ูู ุจุฑูุฏู</h2>
                    <p style="margin: 20px 0; color: #555;">ุชู ุฅุฑุณุงู ุฑุงุจุท ุงูุชูุนูู ุฅูู ุจุฑูุฏู ุงูุฅููุชุฑููู.</p>
                    <button onclick="resendVerificationEmail()">ุฅุนุงุฏุฉ ุฅุฑุณุงู</button>
                    <button class="link-btn" onclick="UI.showLogin()">ุชุณุฌูู ุงูุฏุฎูู</button>
                </div>
            </div>
        </div>

        <!-- ===== ุงูุชุทุจูู ุงูุฑุฆูุณู (ุงูุชุตููู ุงููุฏูู + ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ) ===== -->
        <div id="mainApp" class="hidden" style="display: flex; flex-direction: column; height: 100%;">
            <!-- ุงูุดุฑูุท ุงูุนููู -->
            <div class="top-bar">
                <div class="menu-icon" onclick="UI.toggleDrawer()">โฐ</div>
                <div class="app-name">ุชูุฑููุจ</div>
                <div class="search-icon" onclick="UI.toggleSearch()">๐</div>
            </div>

            <!-- ุดุฑูุท ุงูุจุญุซ -->
            <div id="searchBar" class="search-bar">
                <input type="text" id="searchInput" placeholder="ุงุจุญุซ ุนู ูุณุชุฎุฏู ุฃู ููุงุฉ..." onkeyup="Chat.searchAll()">
                <div id="searchResults" class="search-results"></div>
            </div>

            <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
            <div id="drawerOverlay" class="drawer-overlay" onclick="UI.closeDrawer()"></div>
            <div id="drawer" class="drawer">
                <div class="drawer-header">
                    <div id="drawerAvatar" class="drawer-avatar" onclick="UI.changePhoto()">
                        <span id="avatarInitial">๐ค</span>
                    </div>
                    <div>
                        <div id="drawerFullName">ุงูุงุณู</div>
                        <div id="drawerUsername" style="color: #666; font-size: 14px;">@username</div>
                    </div>
                </div>
                <div class="drawer-menu-item" onclick="UI.showSettings('privacy')"><span>๐</span> ุฎุตูุตูุฉ ูุงูุฃูุงู</div>
                <div class="drawer-menu-item" onclick="UI.showSettings('counters')"><span>๐</span> ุงูุนุฏุงุฏุงุช</div>
                <div class="drawer-menu-item" onclick="UI.showSettings('embed')"><span>๐</span> ุชุถููู ุงููุฏุงุฏุงุช</div>
                <div class="drawer-menu-item" onclick="UI.editName()"><span>โ๏ธ</span> ุชุบููุฑ ุงูุงุณู</div>
                <div class="drawer-menu-item" onclick="UI.editUsername()"><span>๐</span> ุชุบููุฑ ุงุณู ุงููุณุชุฎุฏู</div>
                <div class="drawer-menu-item" onclick="UI.changePhoto()"><span>๐ผ๏ธ</span> ุชุบููุฑ ุงูุตูุฑุฉ</div>
                <div class="drawer-menu-item" onclick="UI.editBio()"><span>๐</span> ุฅุถุงูุฉ ูุจุฐุฉ</div>
                <div class="drawer-menu-item" onclick="UI.toggleDarkMode()"><span>๐</span> ุงููุถุน ุงูุฏุงูู</div>
                <div class="drawer-menu-item" onclick="UI.viewEmail()"><span>๐ง</span> ุนุฑุถ ุงูุจุฑูุฏ</div>
                <div class="drawer-menu-item" onclick="UI.changePassword()"><span>๐</span> ุชุบููุฑ ูููุฉ ุงููุฑูุฑ</div>
                <div class="drawer-menu-item" onclick="Chat.openCreateGroup()"><span>โ</span> ุฅูุดุงุก ููุงุฉ/ูุฌููุนุฉ</div>
                <div class="drawer-menu-item" onclick="Chat.openSavedMessages()"><span>๐พ</span> ุฑุณุงุฆู ูุญููุธุฉ</div>
                <div class="drawer-menu-item" onclick="UI.openSharea()"><span>๐</span> ุงูุณูุงูู ุดุงุนู</div>
                <div style="margin-top: 30px;">
                    <button onclick="Auth.logout()" style="background: #e74c3c;">ุชุณุฌูู ุฎุฑูุฌ</button>
                </div>
            </div>

            <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
            <div id="mainContent" class="main-content">
                <!-- ููุงุฉ ุงููุทูุฑ -->
                <div class="channel-card" onclick="Channel.openChannelChat()">
                    <div class="channel-icon">๐ข</div>
                    <div class="channel-text">
                        <div class="channel-title">ุงููุทูุฑ ุชุทุจูู</div>
                        <div class="channel-sub">ูุฑุญุจ ุจูู ุฅูู ูุธุงู ุงูููุงุฉ ุงูุฎุงุตุฉ ุจุงูุชุทุจูู</div>
                    </div>
                    <div style="background: #f0f0f0; color: #667eea; padding: 4px 12px; border-radius: 16px; font-size: 12px;">700K+</div>
                </div>

                <!-- ูุงุฆูุฉ ุงููุญุงุฏุซุงุช -->
                <div id="chatListContainer" class="chat-list"></div>
            </div>

            <!-- ุบุฑูุฉ ุงูุฏุฑุฏุดุฉ -->
            <div id="chatRoom" class="chat-room">
                <div class="chat-header">
                    <div class="back-btn" onclick="Chat.closeChat()">โ</div>
                    <div id="chatAvatar" class="chat-avatar" style="width: 40px; height: 40px;">๐ค</div>
                    <div class="chat-header-info">
                        <div id="chatName" class="chat-header-name">...</div>
                        <div id="chatStatus" class="chat-header-status">
                            <span id="memberCountDisplay"></span>
                        </div>
                    </div>
                </div>
                <div id="messagesContainer" class="messages-container"></div>
                <div class="chat-input-area">
                    <input type="text" id="messageInput" placeholder="ุงูุชุจ ุฑุณุงูุฉ...">
                    <button id="sendBtn" onclick="Chat.sendMessage()">โค</button>
                </div>
            </div>

            <!-- ุบุฑูุฉ ููุงุฉ ุงููุทูุฑ -->
            <div id="channelChatRoom" class="chat-room">
                <div class="chat-header">
                    <div class="back-btn" onclick="Channel.closeChannelChat()">โ</div>
                    <div class="chat-avatar" style="width: 40px; height: 40px; background: #ff6b6b;">๐ข</div>
                    <div class="chat-header-info">
                        <div class="chat-header-name">ููุงุฉ ุงููุทูุฑ ุชุทุจูู</div>
                        <div id="channelSubscriberCount" class="chat-header-status">725,430 ูุดุชุฑู</div>
                    </div>
                    <button id="subscribeBtn" class="subscribe-btn" onclick="Channel.toggleSubscribe()">ุงุดุชุฑุงู</button>
                </div>
                <div id="channelMessagesContainer" class="messages-container">
                    <div class="message received"><div>๐ ูุฑุญุจุงู ุจู ูู ุงูููุงุฉ ุงูุฑุณููุฉ ูููุทูุฑ!</div><div class="message-time">ููุฐ ุฏูููุฉ</div></div>
                    <div class="message received"><div>๐ ููุง ุณุชุฌุฏ ุขุฎุฑ ุงูุชุญุฏูุซุงุช ูุงูุฃุฎุจุงุฑ</div><div class="message-time">ููุฐ ุฏูููุฉ</div></div>
                </div>
                <div class="chat-input-area">
                    <input type="text" id="channelMessageInput" placeholder="ุงุดุชุฑู ูุชุฑุณู ุฑุณุงูุฉ..." disabled>
                    <button id="channelSendBtn" onclick="Channel.sendChannelMessage()" disabled>โค</button>
                </div>
            </div>

            <!-- ูุงูุฐุฉ ุฅูุดุงุก ููุงุฉ/ูุฌููุนุฉ -->
            <div id="createGroupModal" class="chat-room" style="z-index: 200; background: white;">
                <div class="chat-header">
                    <div class="back-btn" onclick="Chat.closeCreateGroup()">โ</div>
                    <div class="chat-header-info">
                        <div class="chat-header-name">ุฅูุดุงุก ููุงุฉ/ูุฌููุนุฉ</div>
                    </div>
                </div>
                <div style="padding: 20px;">
                    <input type="text" id="groupName" placeholder="ุงุณู ุงูููุงุฉ/ุงููุฌููุนุฉ" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:8px; margin-bottom:16px;">
                    <select id="groupType" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:8px; margin-bottom:16px;">
                        <option value="group">ูุฌููุนุฉ</option>
                        <option value="channel">ููุงุฉ</option>
                    </select>
                    <button onclick="Chat.createGroup()" style="width:100%; padding:12px; background:#667eea; color:white; border:none; border-radius:8px; font-weight:bold;">ุฅูุดุงุก</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ูููุงุช ุงูุฌุงูุงุณูุฑูุจุช (ูุง ุชุบูุฑูุง) -->
    <script src="js/firebase-config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/channel.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
